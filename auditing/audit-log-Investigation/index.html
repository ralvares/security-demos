
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ocpsec.ralvares.com/auditing/audit-log-Investigation/">
      
      
        <link rel="prev" href="../../compliance/compliance-operator-variables/">
      
      
        <link rel="next" href="../kubectl-timemachine-instructions/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Mastering Audit Logs & Forensics - kubernetes/OpenShift Security & Demo and More.</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#forensic-engineering-the-openshift-audit-log-investigation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="kubernetes/OpenShift Security &amp; Demo and More." class="md-header__button md-logo" aria-label="kubernetes/OpenShift Security & Demo and More." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            kubernetes/OpenShift Security & Demo and More.
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mastering Audit Logs & Forensics
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ralvares/security-demos" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ralvares/security-demos
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="kubernetes/OpenShift Security &amp; Demo and More." class="md-nav__button md-logo" aria-label="kubernetes/OpenShift Security & Demo and More." data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    kubernetes/OpenShift Security & Demo and More.
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ralvares/security-demos" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ralvares/security-demos
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    RHACS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    RHACS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../demo_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Demo App
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CIS
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    CIS
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cis/cis-DrivenSecurityOperationsProgram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The CIS-Driven Security Operations Program
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cis/cis-ContinuousVulnerabilityManagement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The CIS-Driven Vulnerability Management Program (VMP)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 1 - Architecture, Threats & Security Strategy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 1 - Architecture, Threats & Security Strategy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/architecture%20and%20threat%20awareness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenShift Security Architecture & Threat Awareness
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The 10 Essential Controls - A Unified Kubernetes Security Playbook
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/the%208%20pillars%20of%20a%20secure%20container%20platform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The 8 Pillars of a Secure Container Platform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/The%20Risk-Driven%20Business%20Conversation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Risk-Driven Business Conversation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 2 - Secure Multi-Tenancy & Project Governance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 2 - Secure Multi-Tenancy & Project Governance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rbac/multi-tenancy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Tenancy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rbac/project-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Automated Project Provisioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 3 - Identity and Access Management
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 3 - Identity and Access Management
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IAM and Admission Control Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rbac/rbac-intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    RBAC Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rbac/custom-roles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Granular Custom Roles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 4 - Admission Control & Enforcement
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 4 - Admission Control & Enforcement
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IAM and Admission Control Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/quota/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resource Quotas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/ClusterResourceQuota/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cluster-Wide Quotas
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/limits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LimitRanges
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/usernamespaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User Namespaces Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_4_6" id="__nav_4_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security Context Constraints (SCC)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security Context Constraints (SCC)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/scc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SCC Fundamentals
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/scc/SCC-LayersOfContainerSecurity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SCC Defense in Depth - DAC & MAC
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/scc/custom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SCC Customization - Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_4_7" id="__nav_4_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    The Real Danger of Privileged Containers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    The Real Danger of Privileged Containers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/ShadowAPI-rke2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SUSE RKE2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/ShadowAPI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenShift
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/vap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validating Admission Policy (VAP) Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admissioncontrols/vap/vap-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validating Admission  Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 5 - Network Security & Isolation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 5 - Network Security & Isolation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Policies - Intro
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/networkpolicies/protecting-the-network-using-networkpolicies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Policies - Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/networkpolicies/adminnetworkpolicies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Admin Network Policies Intro
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/networkpolicies/anp-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Admin Network Policies - Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/zones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Network Security Zones
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 6 - Compliance
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 6 - Compliance
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/compliance-operator-demo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compliance Operator - Custom Rules - Demo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/compliance-operator-variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compliance Operator Custom Rules - Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" checked>
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 7 - Incident Response & Forensics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 7 - Incident Response & Forensics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Mastering Audit Logs & Forensics
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Mastering Audit Logs & Forensics
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-audit-logs-are-critical" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Audit Logs Are Critical
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-audit-log-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Audit Log Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-the-immutable-truth" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: The Immutable Truth
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite-1-storage-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisite 1: Storage Integrity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite-2-the-audit-profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisite 2: The Audit Profile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-the-incident-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: The Incident Scenario
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-the-investigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: The Investigation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: The Investigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-load-the-forensic-library" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup: Load the Forensic Library
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup: Load the Forensic Library">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-investigating-the-entry-point" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Investigating the Entry Point
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Investigating the Entry Point">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-the-asset-cache-pod" class="md-nav__link">
    <span class="md-ellipsis">
      
        About the asset-cache Pod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investigating-the-ip-history-the-identity-switch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Investigating the IP History (The Identity Switch)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-tracking-the-compromised-identity-the-full-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Tracking the Compromised Identity (The Full Picture)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-the-node-takeover" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: The Node Takeover
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forensic-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forensic Timeline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kubectl-timemachine-instructions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubectl Timemachine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Module 8 - Sovereign
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Module 8 - Sovereign
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sovereign/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sovereign Cloud Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-audit-logs-are-critical" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Audit Logs Are Critical
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-audit-log-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Audit Log Structure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-1-the-immutable-truth" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 1: The Immutable Truth
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite-1-storage-integrity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisite 1: Storage Integrity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisite-2-the-audit-profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisite 2: The Audit Profile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-the-incident-scenario" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 2: The Incident Scenario
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-the-investigation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part 3: The Investigation
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part 3: The Investigation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup-load-the-forensic-library" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup: Load the Forensic Library
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup: Load the Forensic Library">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-investigating-the-entry-point" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1: Investigating the Entry Point
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Investigating the Entry Point">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#network-identity" class="md-nav__link">
    <span class="md-ellipsis">
      
        Network Identity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#about-the-asset-cache-pod" class="md-nav__link">
    <span class="md-ellipsis">
      
        About the asset-cache Pod
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#investigating-the-ip-history-the-identity-switch" class="md-nav__link">
    <span class="md-ellipsis">
      
        Investigating the IP History (The Identity Switch)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-tracking-the-compromised-identity-the-full-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2: Tracking the Compromised Identity (The Full Picture)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-the-node-takeover" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3: The Node Takeover
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forensic-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forensic Timeline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conclusion
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="forensic-engineering-the-openshift-audit-log-investigation">Forensic Engineering: The OpenShift Audit Log Investigation</h1>
<h2 id="1-overview">1. Overview</h2>
<p>Audit logs in OpenShift are the authoritative, tamper-evident record of every API request processed by the control plane. Each entry captures <strong>who</strong> performed the action, <strong>what</strong> they did, <strong>when</strong> it occurred, <strong>where</strong> in the cluster it happened, and <strong>how</strong> the request was evaluated.</p>
<p>Properly enabled and analyzed, these logs form the backbone of threat detection, incident response, compliance evidence, and continuous-monitoring programs.</p>
<h3 id="why-audit-logs-are-critical">Why Audit Logs Are Critical</h3>
<ul>
<li><strong>Credential Abuse:</strong> Attackers "log in" with stolen tokens and run standard API calls.</li>
<li><strong>Privilege Escalation:</strong> Misconfigured RoleBindings that silently lift permissions.</li>
<li><strong>Lateral Movement:</strong> Cross-namespace secret reads are often visible only in audit metadata.</li>
<li><strong>Policy Drift:</strong> Excessive SecurityContextConstraints (SCC) exemptions.</li>
</ul>
<h2 id="2-audit-log-structure">2. Audit Log Structure</h2>
<p>Audit events are emitted as JSON objects. Under the <strong>Default</strong> profile, only metadata is captured; request bodies are omitted.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Field</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>timestamp</code></td>
<td style="text-align: left;">Time the API server received the request.</td>
<td style="text-align: left;"><code>2025-07-02T10:15:00Z</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>user.username</code></td>
<td style="text-align: left;">User / service-account identity.</td>
<td style="text-align: left;"><code>system:serviceaccount:default:default</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>user.groups</code></td>
<td style="text-align: left;">Groups attached to the identity.</td>
<td style="text-align: left;"><code>["system:serviceaccounts","system:authenticated"]</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sourceIPs</code></td>
<td style="text-align: left;">Source IP address(es).</td>
<td style="text-align: left;"><code>["10.128.0.45"]</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>verb</code></td>
<td style="text-align: left;">API verb.</td>
<td style="text-align: left;"><code>get</code>, <code>create</code>, <code>delete</code>, <code>patch</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>objectRef.resource</code></td>
<td style="text-align: left;">Target resource kind.</td>
<td style="text-align: left;"><code>secrets</code>, <code>pods</code>, <code>rolebindings</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>objectRef.namespace</code></td>
<td style="text-align: left;">Namespace (project).</td>
<td style="text-align: left;"><code>production</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>subresource</code></td>
<td style="text-align: left;">Subresource acted on.</td>
<td style="text-align: left;"><code>exec</code>, <code>portforward</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>responseStatus.code</code></td>
<td style="text-align: left;">Result of the request.</td>
<td style="text-align: left;"><code>200</code> (OK), <code>403</code> (Forbidden)</td>
</tr>
<tr>
<td style="text-align: left;"><code>annotations</code></td>
<td style="text-align: left;">RBAC decision, PodSecurity/SCC match.</td>
<td style="text-align: left;"><code>"authorization.k8s.io/decision":"allow"</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> Request bodies for <strong>Secret</strong>, <strong>Route</strong>, and <strong>OAuthClient</strong> are <em>never</em> logged in any profile.</p>
</blockquote>
<h2 id="part-1-the-immutable-truth">Part 1: The Immutable Truth</h2>
<p>In any production cluster, observability is crucial. Metrics such as CPU usage and memory consumption provide insights into the <strong>health</strong> of applications. However, during a security incident, the focus shifts from <strong>health</strong> to <strong>accountability</strong> and <strong>intent</strong>.</p>
<p>Audit logs serve as the definitive record of actions within the cluster. They are the authoritative record of the Control Plane, capturing the <strong>5 Ws</strong> of every interaction with the API Server: <strong>Who</strong>, <strong>What</strong>, <strong>Where</strong>, <strong>When</strong>, and the <strong>Decision</strong> (RBAC).</p>
<h2 id="prerequisite-1-storage-integrity">Prerequisite 1: Storage Integrity</h2>
<p>Before we start the hunt, we must address the most important rule of forensic logging: <strong>Storage Integrity.</strong></p>
<p>Audit logs are generated on the Master nodes. If an attacker successfully escalates privileges and takes over the node (Root compromise), they can wipe the log files. Therefore, for these logs to be legally and forensically valid, they <strong>must be forwarded</strong> to an external system (Splunk, Elastic, Remote Syslog).</p>
<h2 id="prerequisite-2-the-audit-profile">Prerequisite 2: The Audit Profile</h2>
<p>Secure logs are useless if they don't contain enough detail. This is defined by the <strong>Audit Log Policy</strong>.</p>
<p>By default, OpenShift uses the <strong>Metadata</strong> profile. This is like a phone bill: it tells you <em>who</em> called <em>whom</em> and for <em>how long</em>, but it does not record the <em>conversation</em>.</p>
<p>For a deep forensic investigation—where we need to see the exact commands an attacker ran (<code>exec</code>), the malicious image they pulled, or the IP address assigned to their pod—we require a higher resolution: <strong>Request Bodies</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Profile</th>
<th style="text-align: left;">Forensic Visibility</th>
<th style="text-align: left;">What you see</th>
<th style="text-align: left;">What you miss</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Default</strong></td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">Metadata (User, Verb, Resource, Response Code).</td>
<td style="text-align: left;"><strong>The Payload.</strong> You cannot see the pod spec (hostPID), the specific command arguments, or the IP assignment in status updates.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>WriteRequestBodies</strong></td>
<td style="text-align: left;"><strong>High (Recommended)</strong></td>
<td style="text-align: left;">All Metadata + <strong>The Full Payload</strong> for "Write" actions (Create, Update, Patch).</td>
<td style="text-align: left;">Read payloads (e.g., you can't see <em>which</em> secret specifically was read if looking at the body, but you know a read happened).</td>
</tr>
<tr>
<td style="text-align: left;"><strong>AllRequestBodies</strong></td>
<td style="text-align: left;">Maximum</td>
<td style="text-align: left;">Everything.</td>
<td style="text-align: left;">Nothing. (Extremely high storage cost).</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Forensic Note:</strong> For this investigation, we assume the cluster was configured with <strong><code>WriteRequestBodies</code></strong>. This allows us to see the "Smoking Gun" evidence: the malicious <code>hostPID</code> flag in the pod creation request and the exact IP address assigned by the Node.</p>
</blockquote>
<hr />
<h2 id="part-2-the-incident-scenario">Part 2: The Incident Scenario</h2>
<p>We are investigating a suspected breach of our "Visa Payment" application. Intelligence suggests a sophisticated Kill Chain involving two specific workloads:</p>
<ul>
<li><strong>Frontend:</strong> <code>asset-cache</code> (Namespace: <code>frontend</code>)</li>
<li><strong>Payments:</strong> <code>visa-processor</code> (Namespace: <code>payments</code>)</li>
</ul>
<p><strong>The Attack Theory:</strong></p>
<ol>
<li><strong>Application Exploit:</strong> The attacker exploited a vulnerability in the <code>asset-cache</code> code. Because this is an application-level exploit, <strong>the Audit Log is blind to it</strong>.</li>
<li><strong>The "Loud" Failure:</strong> The attacker tried to talk to the API from <code>asset-cache</code> but failed because that account is locked down.</li>
<li><strong>Lateral Movement:</strong> They pivoted to the <code>visa-processor</code>, stole the token, and found it had <code>cluster-admin</code> rights due to a misconfiguration in the RoleBinding, which granted excessive privileges to the service account.</li>
<li><strong>The Trigger:</strong> The moment the attacker uses that stolen token to talk to the OpenShift API, they step out of the shadows and into our logs.</li>
</ol>
<p>We will now switch to the terminal to reconstruct this timeline using <strong>Behavioral Analysis</strong>.</p>
<hr />
<h2 id="part-3-the-investigation">Part 3: The Investigation</h2>
<h3 id="setup-load-the-forensic-library">Setup: Load the Forensic Library</h3>
<h4 id="prerequisites">Prerequisites</h4>
<ul>
<li><strong><code>jq</code></strong>: Required for parsing JSON logs.</li>
<li><strong><code>column</code></strong>: (Standard in most Linux/macOS distros) for formatting output.</li>
<li><strong><code>oc</code></strong>: OpenShift CLI (optional, only needed if fetching fresh logs from a cluster).</li>
</ul>
<p>Before we begin, we will load our forensic toolkit. This library contains pre-built functions to query the audit logs efficiently.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/ralvares/security-demos
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>security-demos/use_cases/auditing
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nb">source</span><span class="w"> </span>forensics.sh
</code></pre></div>
<h3 id="step-1-investigating-the-entry-point">Step 1: Investigating the Entry Point</h3>
<p>We begin our investigation by looking for suspicious anonymous API activity originating from within the cluster. Our first clue is a set of <code>403 Forbidden</code> audit log entries where the <code>user</code> is <code>system:anonymous</code> and the <code>sourceIPs</code> field contains an address from the pod network (e.g., <code>10.128.x.y</code>).</p>
<p>By focusing on these events, we can identify API requests that likely originated from a pod, rather than from a node, router, or external source. This method allows us to attribute activity to in-cluster workloads and is a common first step in forensic analysis.</p>
<p>Once we identify a pod IP making these anonymous requests, we can correlate it to a specific workload. </p>
<p>At this stage, we search for anonymous <code>403 Forbidden</code> attempts from the pod network:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>audit_detect_anonymous_access<span class="w"> </span>logs/audit.log
</code></pre></div>
<p>Explanation: Understanding <code>sourceIPs</code>
- The audit field <code>sourceIPs</code> reflects the IPs observed by the API server for the client connection. In most cases, the first element is the pod IP (e.g., <code>10.128.x.y</code>).
- For deeper enrichment, OpenShift Network Observability can link the IP to the pod/workload, namespace, and node, providing a quick pivot from IP → pod → owner.</p>
<h4 id="network-identity">Network Identity</h4>
<p>Finally, to correlate network flows with these events, we need to know the IP address assigned to the malicious pod at the time of creation. In OpenShift/OVN, this is stored in the <code>k8s.ovn.org/pod-networks</code> annotation.</p>
<p><strong>The Query:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">TARGET_IP</span><span class="o">=</span><span class="m">10</span>.128.1.81
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>audit_lookup_pod_by_ip<span class="w"> </span>logs/audit.log<span class="w"> </span><span class="nv">$TARGET_IP</span>
</code></pre></div></p>
<p><strong>The Finding:</strong>
This reveals the ephemeral IP address assigned to the asset-cache pod.</p>
<h4 id="about-the-asset-cache-pod">About the asset-cache Pod</h4>
<p>Through this correlation, we determined that the suspicious pod IP belonged to the <code>asset-cache</code> pod in the <code>frontend</code> namespace. The <code>asset-cache</code> application is a stateless frontend cache service, typically exposed to external traffic and designed to improve performance by storing frequently accessed data. In this scenario, it was running with minimal privileges and, crucially, did not mount a Kubernetes service account token.</p>
<p>This lack of a service account token meant that any API requests made from the pod would be anonymous. The attacker exploited a remote code execution (RCE) vulnerability in the <code>asset-cache</code> application, allowing them to run arbitrary commands inside the pod. Their first attempts to access the Kubernetes API were therefore made as <code>system:anonymous</code>, and were blocked by RBAC, as seen in the audit logs.</p>
<p>Only after linking the pod IP to the <code>asset-cache</code> workload did we realize this was the initial entry point for the attack chain. This highlights the importance of correlating network-level evidence with workload metadata during forensic investigations.</p>
<p><strong>The Finding:</strong>
We see multiple entries. The attacker tried to <code>list secrets</code> and <code>get pods</code> from the <code>asset-cache</code> pod, but OpenShift blocked them (403).</p>
<ul>
<li><strong>Forensic Insight:</strong> This confirms the pod is compromised, but the attacker hit a wall. They need a valid account.</li>
</ul>
<h4 id="investigating-the-ip-history-the-identity-switch">Investigating the IP History (The Identity Switch)</h4>
<p>Now that we have a suspicious IP (<code>10.128.1.81</code>), we must ask: <strong>"Did this IP ever succeed?"</strong></p>
<p>We run a history check on this specific IP to see if it ever made a request with a <em>valid</em> identity. This is how we detect if the attacker managed to steal a token and use it from the compromised pod.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">TARGET_IP</span><span class="o">=</span><span class="s2">&quot;10.128.1.81&quot;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>audit_track_ip_activity<span class="w"> </span>logs/audit.log<span class="w"> </span><span class="nv">$TARGET_IP</span>
</code></pre></div>
<p><strong>The Finding:</strong>
We observe a critical shift. The logs show initial <code>system:anonymous</code> failures (403), followed by successful requests (200) authenticated as <code>system:serviceaccount:payments:visa-processor</code>.</p>
<p><strong>Conclusion:</strong> The attacker did not just stay in <code>asset-cache</code>. They stole the token of the <code>visa-processor</code> service account and are using it <em>from</em> the <code>asset-cache</code> pod (or they moved to the <code>visa-processor</code> pod, but the IP correlation suggests the former if the IP matches). <em>Note: If the IP changed, we would track the new IP.</em></p>
<h3 id="step-2-tracking-the-compromised-identity-the-full-picture">Step 2: Tracking the Compromised Identity (The Full Picture)</h3>
<p>Exploiting the lack of NetworkPolicies, the attacker moved laterally to the <code>visa-processor</code> pod and abused a known vulnerability in its outdated Apache Struts to gain access and steal the token.</p>
<p>Now that we have identified the compromised account (<code>system:serviceaccount:payments:visa-processor</code>), we don't need to run individual detection scripts for every possible attack vector. We can simply ask the audit log: <em>'What did this user do?'</em></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>audit_track_user_activity<span class="w"> </span>logs/audit.log<span class="w"> </span>system:serviceaccount:payments:visa-processor
</code></pre></div>
<p><strong>The Finding:</strong>
The output reveals the entire Kill Chain in chronological order:</p>
<ol>
<li><strong>Reconnaissance:</strong> <code>create selfsubjectaccessreviews</code>. The attacker checked their own permissions.</li>
<li><strong>Credential Harvesting:</strong> <code>list secrets</code>. The attacker dumped all secrets in the cluster.</li>
<li><strong>Privilege Escalation:</strong> <code>create pods</code>. The attacker created a pod named <code>visa-processor</code> in the <code>payments-v2</code> namespace.</li>
<li><strong>Lateral Movement/Persistence:</strong> <code>create pods/exec</code>. The attacker opened an interactive shell into that pod.</li>
</ol>
<p>This single command confirms the attacker moved from simple discovery to active exploitation and established a backdoor.</p>
<p>This led to the final, critical chapter of the investigation: <strong>The Node Compromise</strong>.</p>
<hr />
<h3 id="step-3-the-node-takeover">Step 3: The Node Takeover</h3>
<blockquote>
<p><strong>Note:</strong> The following forensic analysis assumes that your audit log profile is set to capture request bodies (e.g., <code>WriteRequestBodies</code> or <code>AllRequestBodies</code>). Without this, you will not see the full pod spec, container image, or command in the audit log. Since pods are often short-lived, other methods (such as external SIEM, EDR, or node-level forensics) are required to reconstruct the attack if audit bodies are not available.</p>
</blockquote>
<p>At this stage, the attacker has achieved a privileged foothold inside the <code>visa-processor</code> pod, which was created with both <code>hostPID: true</code> and <code>privileged: true</code>. These settings effectively remove most container boundaries, granting the attacker visibility and control over the host node's processes and resources.</p>
<p>The next move is inferred from the pod specification: the attacker likely attempts to escape the container namespace and access the host's filesystem and process space. While we often suspect tools like <code>nsenter</code>, the audit log does not capture what happens inside the container. Instead, we rely on forensic signals from the pod spec:</p>
<ul>
<li><strong>Pod creation with <code>hostPID</code> and <code>privileged</code></strong>: The audit log shows the creation of a pod with these dangerous settings, a strong indicator of an attempted container escape.</li>
<li><strong>Suspicious or unusual commands</strong>: If the audit log profile captures request bodies, you can see the full command array used to launch the container. Any command that attempts namespace manipulation (e.g., <code>nsenter</code>, <code>chroot</code>, <code>mount</code>, or custom binaries) is a red flag, but even generic shells (<code>/bin/bash</code>, <code>/bin/sh</code>) in privileged pods should be scrutinized.</li>
<li><strong>Container image used</strong>: The audit log also reveals the image specified for the pod. Unusual or minimal images (like <code>alpine</code>, <code>busybox</code>), or images not normally used in your environment, can indicate attacker activity or attempts to evade detection.</li>
<li><strong>Sensitive hostPath mounts</strong>: The attacker may also mount critical host directories (like <code>/</code>, <code>/etc</code>, <code>/var/run</code>, <code>/root</code>, or <code>/etc/kubernetes</code>) into the pod, providing direct access to the node's files.</li>
</ul>
<p>By reviewing the pod spec in the audit log, you can:
* See the exact container image and command used, providing context for the attacker's intent and tooling—without needing to guess the method (e.g., <code>nsenter</code>).
* Correlate suspicious images and commands with dangerous settings (<code>hostPID</code>, <code>privileged</code>, sensitive hostPath mounts) to build a high-confidence picture of a node compromise attempt.</p>
<p>Once on the node, the attacker can:
* Read or modify sensitive files.
* Create or alter static pod manifests for persistence.
* Access container runtime sockets to control other containers or escalate further.
* etc..</p>
<p><strong>Forensic Implications:</strong>
While the actual use of escape tools and subsequent host actions are not visible in Kubernetes audit logs, the combination of these pod creation events, dangerous settings, suspicious commands, unusual images, and sensitive mounts is a high-fidelity signal of node compromise. The queries below help you spot these behaviors.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">POD_NAME</span><span class="o">=</span><span class="s2">&quot;visa-processor&quot;</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>audit_track_pod_lifecycle<span class="w"> </span>logs/audit.log<span class="w"> </span><span class="nv">$POD_NAME</span>
</code></pre></div>
<p><strong>The Finding:</strong>
We see the pod created with a command that explicitly invokes <code>nsenter</code>, confirming the attacker's intent to escape the container and access the host.</p>
<hr />
<h2 id="forensic-timeline">Forensic Timeline</h2>
<p>We have now reconstructed the <em>entire</em> Kill Chain, from the first failed probe to total infrastructure compromise.</p>
<pre class="mermaid"><code>flowchart TD
    %% Define Styles
    classDef frontend fill:#ffebee,stroke:#c62828,stroke-width:2px;
    classDef lateral fill:#fff3e0,stroke:#ef6c00,stroke-width:2px;
    classDef escalation fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px;
    classDef takeover fill:#212121,stroke:#000,stroke-width:2px,color:#fff;

    subgraph Phase1 ["Phase 1: The Noisy Neighbor"]
        A["Log: asset-cache gets 403 Forbidden"]:::frontend
        Note1["Attacker has RCE but no permissions"]
    end

    subgraph Phase2 ["Phase 2: Lateral Movement"]
        B["Log: visa-processor checks SelfPermissions"]:::lateral
        C["Log: visa-processor Lists Secrets"]:::lateral
        Note2["Token stolen &amp; credential harvesting"]
    end

    subgraph Phase3 ["Phase 3: Escalation"]
        D["Log: visa-processor creates pod fake visa-processor (HostPID)"]:::escalation
        E["Log: visa-processor execs into fake visa-processor"]:::escalation
        Note3["Container Escape &amp; Privileged Access"]
    end

    subgraph Phase4 ["Phase 4: Impact"]
        F["Log: Fake visa-processor access Host Namespace"]:::takeover
        Note4["Physical Node Compromised"]
    end

    A --&gt; B --&gt; C --&gt; D --&gt; E --&gt; F</code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>We have reconstructed the crime scene using only the Audit Logs, mapping the attack to the <strong>MITRE ATT\&amp;CK</strong> framework:</p>
<ol>
<li><strong>Asset-Cache (Frontend):</strong> <code>403 Forbidden</code> on API calls. <em>Conclusion: Compromised, but contained by RBAC.</em></li>
<li><strong>Visa-Processor (Lateral Move):</strong> <code>SelfSubjectAccessReview</code>. <em>Conclusion: Token stolen, Reconnaissance detected.</em></li>
<li><strong>Visa-Processor (Exfiltration):</strong> <code>List Secrets</code>. <em>Conclusion: Credential Harvesting.</em></li>
<li><strong>Visa-Processor (Escalation):</strong> Deployed <code>fake visa-processor</code> with <code>HostPID</code>. <em>Conclusion: Container Escape.</em></li>
<li><strong>Visa-Processor (Action):</strong> Executed shell in <code>fake visa-processor</code>. <em>Conclusion: Node Takeover.</em></li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>